"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/chat/page",{

/***/ "(app-pages-browser)/./src/app/chat/page.tsx":
/*!*******************************!*\
  !*** ./src/app/chat/page.tsx ***!
  \*******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ChatPage)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/../../node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/../../node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-redux */ \"(app-pages-browser)/../../node_modules/react-redux/dist/react-redux.mjs\");\n/* harmony import */ var _contexts_ChatContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/contexts/ChatContext */ \"(app-pages-browser)/./src/contexts/ChatContext.tsx\");\n/* harmony import */ var _components_ui_button__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/ui/button */ \"(app-pages-browser)/./src/components/ui/button.tsx\");\n/* harmony import */ var _components_ui_input__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/components/ui/input */ \"(app-pages-browser)/./src/components/ui/input.tsx\");\n/* harmony import */ var _components_ui_card__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/components/ui/card */ \"(app-pages-browser)/./src/components/ui/card.tsx\");\n/* harmony import */ var _components_ChatConnectionStatus__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/components/ChatConnectionStatus */ \"(app-pages-browser)/./src/components/ChatConnectionStatus.tsx\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\nfunction ChatPage() {\n    _s();\n    const [localMessages, setLocalMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [receiverId, setReceiverId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"seller123\");\n    const [listingId, setListingId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"listing123\");\n    const [showDebug, setShowDebug] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [isClient, setIsClient] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [lastReceivedMessage, setLastReceivedMessage] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const user = (0,react_redux__WEBPACK_IMPORTED_MODULE_7__.useSelector)({\n        \"ChatPage.useSelector[user]\": (state)=>state.auth.user\n    }[\"ChatPage.useSelector[user]\"]);\n    const userId = (user === null || user === void 0 ? void 0 : user.id) || \"test-user\";\n    // Prevent hydration mismatch\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"ChatPage.useEffect\": ()=>{\n            setIsClient(true);\n        }\n    }[\"ChatPage.useEffect\"], []);\n    const { sendMessage, isConnected, isConnecting, hasError, connectionStatus, reconnect, addMessageListener } = (0,_contexts_ChatContext__WEBPACK_IMPORTED_MODULE_2__.useChat)();\n    // Listen for all messages\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"ChatPage.useEffect\": ()=>{\n            const unsubscribe = addMessageListener({\n                \"ChatPage.useEffect.unsubscribe\": (msg)=>{\n                    console.log(\"📨 Received message in chat page:\", msg);\n                    setLastReceivedMessage(JSON.stringify(msg, null, 2));\n                    setLocalMessages({\n                        \"ChatPage.useEffect.unsubscribe\": (prev)=>[\n                                ...prev,\n                                msg\n                            ]\n                    }[\"ChatPage.useEffect.unsubscribe\"]);\n                }\n            }[\"ChatPage.useEffect.unsubscribe\"]);\n            return unsubscribe;\n        }\n    }[\"ChatPage.useEffect\"], [\n        addMessageListener\n    ]);\n    const handleSend = ()=>{\n        if (input.trim() && isConnected) {\n            const message = {\n                senderId: userId,\n                senderName: (user === null || user === void 0 ? void 0 : user.name) || \"Test User\",\n                receiverId,\n                content: input.trim(),\n                listingId\n            };\n            console.log(\"📤 Sending message:\", message);\n            // Add message to local state immediately for better UX\n            setLocalMessages((prev)=>[\n                    ...prev,\n                    message\n                ]);\n            const success = sendMessage(message);\n            if (success) {\n                setInput(\"\");\n                console.log(\"✅ Message sent successfully\");\n            } else {\n                console.error(\"❌ Failed to send message\");\n                // Remove the message from local state if sending failed\n                setLocalMessages((prev)=>prev.filter((m)=>m !== message));\n            }\n        }\n    };\n    const handleTestMessage = ()=>{\n        if (isConnected) {\n            const testMessage = {\n                senderId: userId,\n                senderName: (user === null || user === void 0 ? void 0 : user.name) || \"Test User\",\n                receiverId: \"test-receiver\",\n                content: \"This is a test message at \" + new Date().toLocaleTimeString(),\n                listingId: \"test-listing\"\n            };\n            console.log(\"🧪 Sending test message:\", testMessage);\n            const success = sendMessage(testMessage);\n            if (success) {\n                console.log(\"✅ Test message sent successfully\");\n            } else {\n                console.error(\"❌ Failed to send test message\");\n            }\n        } else {\n            console.error(\"❌ Cannot send test message: not connected\");\n        }\n    };\n    const handleKeyPress = (e)=>{\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            e.preventDefault();\n            handleSend();\n        }\n    };\n    const getConnectionStatusText = ()=>{\n        switch(connectionStatus){\n            case \"connecting\":\n                return \"Connecting to chat...\";\n            case \"connected\":\n                return \"Connected\";\n            case \"error\":\n                return \"Connection Error\";\n            case \"disconnected\":\n                return \"Disconnected - trying to reconnect...\";\n            default:\n                return \"Unknown status\";\n        }\n    };\n    const getConnectionStatusColor = ()=>{\n        switch(connectionStatus){\n            case \"connecting\":\n                return \"text-yellow-500\";\n            case \"connected\":\n                return \"text-green-500\";\n            case \"error\":\n                return \"text-red-500\";\n            case \"disconnected\":\n                return \"text-red-500\";\n            default:\n                return \"text-gray-500\";\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"max-w-4xl mx-auto px-4 py-12\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h1\", {\n                className: \"text-3xl font-bold mb-6\",\n                children: \"Chat Test\"\n            }, void 0, false, {\n                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                lineNumber: 130,\n                columnNumber: 7\n            }, this),\n            showDebug && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ChatConnectionStatus__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n                connectionStatus: connectionStatus,\n                isConnected: isConnected,\n                isConnecting: isConnecting,\n                hasError: hasError,\n                onReconnect: reconnect\n            }, void 0, false, {\n                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                lineNumber: 134,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"grid grid-cols-1 lg:grid-cols-3 gap-6\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_card__WEBPACK_IMPORTED_MODULE_5__.Card, {\n                        className: \"p-4\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex items-center justify-between mb-4\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                                        className: \"text-lg font-semibold\",\n                                        children: \"Chat Settings\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 147,\n                                        columnNumber: 13\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.Button, {\n                                        variant: \"outline\",\n                                        size: \"sm\",\n                                        onClick: ()=>setShowDebug(!showDebug),\n                                        children: [\n                                            showDebug ? \"Hide\" : \"Show\",\n                                            \" Debug\"\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 148,\n                                        columnNumber: 13\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                lineNumber: 146,\n                                columnNumber: 11\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"space-y-4\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"label\", {\n                                                className: \"block text-sm font-medium mb-1\",\n                                                children: \"Your ID:\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 158,\n                                                columnNumber: 15\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_input__WEBPACK_IMPORTED_MODULE_4__.Input, {\n                                                value: isClient ? userId : \"Loading...\",\n                                                disabled: true\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 159,\n                                                columnNumber: 15\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 157,\n                                        columnNumber: 13\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"label\", {\n                                                className: \"block text-sm font-medium mb-1\",\n                                                children: \"Receiver ID:\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 162,\n                                                columnNumber: 15\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_input__WEBPACK_IMPORTED_MODULE_4__.Input, {\n                                                value: receiverId,\n                                                onChange: (e)=>setReceiverId(e.target.value),\n                                                placeholder: \"Enter receiver ID\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 163,\n                                                columnNumber: 15\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 161,\n                                        columnNumber: 13\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"label\", {\n                                                className: \"block text-sm font-medium mb-1\",\n                                                children: \"Listing ID:\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 170,\n                                                columnNumber: 15\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_input__WEBPACK_IMPORTED_MODULE_4__.Input, {\n                                                value: listingId,\n                                                onChange: (e)=>setListingId(e.target.value),\n                                                placeholder: \"Enter listing ID\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 171,\n                                                columnNumber: 15\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 169,\n                                        columnNumber: 13\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"flex items-center space-x-2\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"w-3 h-3 rounded-full \".concat(connectionStatus === \"connected\" ? \"bg-green-500\" : connectionStatus === \"connecting\" ? \"bg-yellow-500\" : connectionStatus === \"error\" ? \"bg-red-500\" : \"bg-gray-500\")\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 178,\n                                                columnNumber: 15\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                className: \"text-sm \".concat(getConnectionStatusColor()),\n                                                children: getConnectionStatusText()\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 183,\n                                                columnNumber: 15\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 177,\n                                        columnNumber: 13\n                                    }, this),\n                                    connectionStatus === \"error\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"text-xs text-gray-500\",\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.Button, {\n                                            variant: \"outline\",\n                                            size: \"sm\",\n                                            onClick: reconnect,\n                                            className: \"w-full\",\n                                            children: \"Manual Reconnect\"\n                                        }, void 0, false, {\n                                            fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                            lineNumber: 189,\n                                            columnNumber: 17\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 188,\n                                        columnNumber: 15\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.Button, {\n                                        variant: \"outline\",\n                                        onClick: handleTestMessage,\n                                        disabled: !isConnected,\n                                        className: \"w-full\",\n                                        children: \"Send Test Message\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 201,\n                                        columnNumber: 13\n                                    }, this),\n                                    isClient && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"mt-4 p-2 bg-gray-100 rounded text-xs\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"font-medium mb-1\",\n                                                children: \"Debug Info:\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 213,\n                                                columnNumber: 17\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: [\n                                                    \"Messages count: \",\n                                                    localMessages.length\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 214,\n                                                columnNumber: 17\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: [\n                                                    \"Connection: \",\n                                                    connectionStatus\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 215,\n                                                columnNumber: 17\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: [\n                                                    \"User ID: \",\n                                                    userId\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 216,\n                                                columnNumber: 17\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: [\n                                                    \"Receiver ID: \",\n                                                    receiverId\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 217,\n                                                columnNumber: 17\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                children: [\n                                                    \"Listing ID: \",\n                                                    listingId\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 218,\n                                                columnNumber: 17\n                                            }, this),\n                                            lastReceivedMessage && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"mt-2\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"font-medium\",\n                                                        children: \"Last Received:\"\n                                                    }, void 0, false, {\n                                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                        lineNumber: 221,\n                                                        columnNumber: 21\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"pre\", {\n                                                        className: \"text-xs bg-white p-1 rounded overflow-auto max-h-20\",\n                                                        children: lastReceivedMessage\n                                                    }, void 0, false, {\n                                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                        lineNumber: 222,\n                                                        columnNumber: 21\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 220,\n                                                columnNumber: 19\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 212,\n                                        columnNumber: 15\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                lineNumber: 156,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                        lineNumber: 145,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"lg:col-span-2\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_card__WEBPACK_IMPORTED_MODULE_5__.Card, {\n                            className: \"h-96 flex flex-col\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"p-4 border-b\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                                        className: \"text-lg font-semibold\",\n                                        children: \"Messages\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 236,\n                                        columnNumber: 15\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                    lineNumber: 235,\n                                    columnNumber: 13\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex-1 overflow-y-auto p-4 space-y-2\",\n                                    children: localMessages.length === 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"text-center text-gray-500 py-8\",\n                                        children: connectionStatus === \"connected\" ? \"No messages yet. Start a conversation!\" : \"Connecting to chat service...\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                        lineNumber: 241,\n                                        columnNumber: 17\n                                    }, this) : localMessages.map((msg, idx)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"flex \".concat(msg.senderId === userId ? \"justify-end\" : \"justify-start\"),\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"max-w-xs px-3 py-2 rounded-lg text-sm \".concat(msg.senderId === userId ? \"bg-blue-500 text-white\" : \"bg-gray-200 text-gray-800\"),\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"font-medium text-xs mb-1\",\n                                                        children: msg.senderName\n                                                    }, void 0, false, {\n                                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                        lineNumber: 262,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        children: msg.content\n                                                    }, void 0, false, {\n                                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                        lineNumber: 265,\n                                                        columnNumber: 23\n                                                    }, this),\n                                                    msg.timestamp && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"text-xs opacity-70 mt-1\",\n                                                        children: new Date(msg.timestamp).toLocaleTimeString()\n                                                    }, void 0, false, {\n                                                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                        lineNumber: 267,\n                                                        columnNumber: 25\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                lineNumber: 255,\n                                                columnNumber: 21\n                                            }, this)\n                                        }, msg.id || idx, false, {\n                                            fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                            lineNumber: 249,\n                                            columnNumber: 19\n                                        }, this))\n                                }, void 0, false, {\n                                    fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                    lineNumber: 239,\n                                    columnNumber: 13\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"p-4 border-t\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"flex space-x-2\",\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_input__WEBPACK_IMPORTED_MODULE_4__.Input, {\n                                                    value: input,\n                                                    onChange: (e)=>setInput(e.target.value),\n                                                    onKeyPress: handleKeyPress,\n                                                    placeholder: connectionStatus === \"connected\" ? \"Type your message...\" : \"Connecting...\",\n                                                    disabled: !isConnected || isConnecting,\n                                                    className: \"flex-1\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                    lineNumber: 279,\n                                                    columnNumber: 17\n                                                }, this),\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_3__.Button, {\n                                                    onClick: handleSend,\n                                                    disabled: !input.trim() || !isConnected || isConnecting,\n                                                    children: \"Send\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                                    lineNumber: 291,\n                                                    columnNumber: 17\n                                                }, this)\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                            lineNumber: 278,\n                                            columnNumber: 15\n                                        }, this),\n                                        connectionStatus !== \"connected\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                            className: \"text-xs mt-1 \".concat(getConnectionStatusColor()),\n                                            children: getConnectionStatusText()\n                                        }, void 0, false, {\n                                            fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                            lineNumber: 299,\n                                            columnNumber: 17\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                                    lineNumber: 277,\n                                    columnNumber: 13\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                            lineNumber: 234,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                        lineNumber: 233,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n                lineNumber: 143,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/app/chat/page.tsx\",\n        lineNumber: 129,\n        columnNumber: 5\n    }, this);\n}\n_s(ChatPage, \"5aG4rrOvv7jD36QNXXUc9cFkETw=\", false, function() {\n    return [\n        react_redux__WEBPACK_IMPORTED_MODULE_7__.useSelector,\n        _contexts_ChatContext__WEBPACK_IMPORTED_MODULE_2__.useChat\n    ];\n});\n_c = ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9hcHAvY2hhdC9wYWdlLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFFNEM7QUFDRjtBQUVvQjtBQUNkO0FBQ0Y7QUFDRjtBQUN5QjtBQUV0RCxTQUFTUTs7SUFDdEIsTUFBTSxDQUFDQyxlQUFlQyxpQkFBaUIsR0FBR1YsK0NBQVFBLENBQWdCLEVBQUU7SUFDcEUsTUFBTSxDQUFDVyxPQUFPQyxTQUFTLEdBQUdaLCtDQUFRQSxDQUFDO0lBQ25DLE1BQU0sQ0FBQ2EsWUFBWUMsY0FBYyxHQUFHZCwrQ0FBUUEsQ0FBQztJQUM3QyxNQUFNLENBQUNlLFdBQVdDLGFBQWEsR0FBR2hCLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQ2lCLFdBQVdDLGFBQWEsR0FBR2xCLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQ21CLFVBQVVDLFlBQVksR0FBR3BCLCtDQUFRQSxDQUFDO0lBQ3pDLE1BQU0sQ0FBQ3FCLHFCQUFxQkMsdUJBQXVCLEdBQUd0QiwrQ0FBUUEsQ0FBUztJQUV2RSxNQUFNdUIsT0FBT3JCLHdEQUFXQTtzQ0FBQyxDQUFDc0IsUUFBcUJBLE1BQU1DLElBQUksQ0FBQ0YsSUFBSTs7SUFDOUQsTUFBTUcsU0FBU0gsQ0FBQUEsaUJBQUFBLDJCQUFBQSxLQUFNSSxFQUFFLEtBQUk7SUFFM0IsNkJBQTZCO0lBQzdCMUIsZ0RBQVNBOzhCQUFDO1lBQ1JtQixZQUFZO1FBQ2Q7NkJBQUcsRUFBRTtJQUVMLE1BQU0sRUFBRVEsV0FBVyxFQUFFQyxXQUFXLEVBQUVDLFlBQVksRUFBRUMsUUFBUSxFQUFFQyxnQkFBZ0IsRUFBRUMsU0FBUyxFQUFFQyxrQkFBa0IsRUFBRSxHQUFHL0IsOERBQU9BO0lBRXJILDBCQUEwQjtJQUMxQkYsZ0RBQVNBOzhCQUFDO1lBQ1IsTUFBTWtDLGNBQWNEO2tEQUFtQixDQUFDRTtvQkFDdENDLFFBQVFDLEdBQUcsQ0FBQyxxQ0FBcUNGO29CQUNqRGQsdUJBQXVCaUIsS0FBS0Ms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QVMsa0JBQ1osOERBQUNuQjt3REFBSUMsV0FBVTtrRUFDWixJQUFJVixLQUFLbkIsSUFBSStDLFNBQVMsRUFBRTNCLGtCQUFrQjs7Ozs7Ozs7Ozs7OzJDQWxCNUNwQixJQUFJVCxFQUFFLElBQUl1RDs7Ozs7Ozs7Ozs4Q0EyQnZCLDhEQUFDbEI7b0NBQUlDLFdBQVU7O3NEQUNiLDhEQUFDRDs0Q0FBSUMsV0FBVTs7OERBQ2IsOERBQUM1RCx1REFBS0E7b0RBQ0pvRSxPQUFPOUQ7b0RBQ1BnRSxVQUFVLENBQUNqQixJQUFNOUMsU0FBUzhDLEVBQUVrQixNQUFNLENBQUNILEtBQUs7b0RBQ3hDVyxZQUFZM0I7b0RBQ1pvQixhQUNFN0MscUJBQXFCLGNBQ2pCLHlCQUNBO29EQUVOMEMsVUFBVSxDQUFDN0MsZUFBZUM7b0RBQzFCbUMsV0FBVTs7Ozs7OzhEQUVaLDhEQUFDN0QseURBQU1BO29EQUNMbUUsU0FBUzdCO29EQUNUZ0MsVUFBVSxDQUFDL0QsTUFBTWdDLElBQUksTUFBTSxDQUFDZCxlQUFlQzs4REFDNUM7Ozs7Ozs7Ozs7Ozt3Q0FJRkUscUJBQXFCLDZCQUNwQiw4REFBQ3FEOzRDQUFFcEIsV0FBVyxnQkFBMkMsT0FBM0JGO3NEQUMzQkQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBU25CO0dBelN3QnREOztRQVNUTixvREFBV0E7UUFRc0ZDLDBEQUFPQTs7O0tBakIvRksiLCJzb3VyY2VzIjpbIi9Vc2Vycy9uaWhhbC9EZXNrdG9wL05paGFsL1Byb2plY3RzL2xpc3RyaS9hcHBzL2Zyb250ZW5kL3NyYy9hcHAvY2hhdC9wYWdlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU2VsZWN0b3IgfSBmcm9tIFwicmVhY3QtcmVkdXhcIjtcbmltcG9ydCB7IFJvb3RTdGF0ZSB9IGZyb20gXCJAL3N0b3JlXCI7XG5pbXBvcnQgeyB1c2VDaGF0LCBDaGF0TWVzc2FnZSB9IGZyb20gXCJAL2NvbnRleHRzL0NoYXRDb250ZXh0XCI7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2J1dHRvblwiO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2lucHV0XCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9jYXJkXCI7XG5pbXBvcnQgQ2hhdENvbm5lY3Rpb25TdGF0dXMgZnJvbSBcIkAvY29tcG9uZW50cy9DaGF0Q29ubmVjdGlvblN0YXR1c1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBDaGF0UGFnZSgpIHtcbiAgY29uc3QgW2xvY2FsTWVzc2FnZXMsIHNldExvY2FsTWVzc2FnZXNdID0gdXNlU3RhdGU8Q2hhdE1lc3NhZ2VbXT4oW10pO1xuICBjb25zdCBbaW5wdXQsIHNldElucHV0XSA9IHVzZVN0YXRlKFwiXCIpO1xuICBjb25zdCBbcmVjZWl2ZXJJZCwgc2V0UmVjZWl2ZXJJZF0gPSB1c2VTdGF0ZShcInNlbGxlcjEyM1wiKTtcbiAgY29uc3QgW2xpc3RpbmdJZCwgc2V0TGlzdGluZ0lkXSA9IHVzZVN0YXRlKFwibGlzdGluZzEyM1wiKTtcbiAgY29uc3QgW3Nob3dEZWJ1Zywgc2V0U2hvd0RlYnVnXSA9IHVzZVN0YXRlKHRydWUpO1xuICBjb25zdCBbaXNDbGllbnQsIHNldElzQ2xpZW50XSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2xhc3RSZWNlaXZlZE1lc3NhZ2UsIHNldExhc3RSZWNlaXZlZE1lc3NhZ2VdID0gdXNlU3RhdGU8c3RyaW5nPihcIlwiKTtcblxuICBjb25zdCB1c2VyID0gdXNlU2VsZWN0b3IoKHN0YXRlOiBSb290U3RhdGUpID0+IHN0YXRlLmF1dGgudXNlcik7XG4gIGNvbnN0IHVzZXJJZCA9IHVzZXI/LmlkIHx8IFwidGVzdC11c2VyXCI7XG5cbiAgLy8gUHJldmVudCBoeWRyYXRpb24gbWlzbWF0Y2hcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRJc0NsaWVudCh0cnVlKTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHsgc2VuZE1lc3NhZ2UsIGlzQ29ubmVjdGVkLCBpc0Nvbm5lY3RpbmcsIGhhc0Vycm9yLCBjb25uZWN0aW9uU3RhdHVzLCByZWNvbm5lY3QsIGFkZE1lc3NhZ2VMaXN0ZW5lciB9ID0gdXNlQ2hhdCgpO1xuXG4gIC8vIExpc3RlbiBmb3IgYWxsIG1lc3NhZ2VzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgdW5zdWJzY3JpYmUgPSBhZGRNZXNzYWdlTGlzdGVuZXIoKG1zZzogQ2hhdE1lc3NhZ2UpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+TqCBSZWNlaXZlZCBtZXNzYWdlIGluIGNoYXQgcGFnZTpcIiwgbXNnKTtcbiAgICAgIHNldExhc3RSZWNlaXZlZE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkobXNnLCBudWxsLCAyKSk7XG4gICAgICBzZXRMb2NhbE1lc3NhZ2VzKHByZXYgPT4gWy4uLnByZXYsIG1zZ10pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHVuc3Vic2NyaWJlO1xuICB9LCBbYWRkTWVzc2FnZUxpc3RlbmVyXSk7XG5cbiAgY29uc3QgaGFuZGxlU2VuZCA9ICgpID0+IHtcbiAgICBpZiAoaW5wdXQudHJpbSgpICYmIGlzQ29ubmVjdGVkKSB7XG4gICAgICBjb25zdCBtZXNzYWdlOiBDaGF0TWVzc2FnZSA9IHtcbiAgICAgICAgc2VuZGVySWQ6IHVzZXJJZCxcbiAgICAgICAgc2VuZGVyTmFtZTogdXNlcj8ubmFtZSB8fCBcIlRlc3QgVXNlclwiLFxuICAgICAgICByZWNlaXZlcklkLFxuICAgICAgICBjb250ZW50OiBpbnB1dC50cmltKCksXG4gICAgICAgIGxpc3RpbmdJZCxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+TpCBTZW5kaW5nIG1lc3NhZ2U6XCIsIG1lc3NhZ2UpO1xuICAgICAgXG4gICAgICAvLyBBZGQgbWVzc2FnZSB0byBsb2NhbCBzdGF0ZSBpbW1lZGlhdGVseSBmb3IgYmV0dGVyIFVYXG4gICAgICBzZXRMb2NhbE1lc3NhZ2VzKChwcmV2KSA9PiBbLi4ucHJldiwgbWVzc2FnZV0pO1xuICAgICAgXG4gICAgICBjb25zdCBzdWNjZXNzID0gc2VuZE1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICBzZXRJbnB1dChcIlwiKTtcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgTWVzc2FnZSBzZW50IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRmFpbGVkIHRvIHNlbmQgbWVzc2FnZVwiKTtcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBtZXNzYWdlIGZyb20gbG9jYWwgc3RhdGUgaWYgc2VuZGluZyBmYWlsZWRcbiAgICAgICAgc2V0TG9jYWxNZXNzYWdlcygocHJldikgPT4gcHJldi5maWx0ZXIobSA9PiBtICE9PSBtZXNzYWdlKSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGhhbmRsZVRlc3RNZXNzYWdlID0gKCkgPT4ge1xuICAgIGlmIChpc0Nvbm5lY3RlZCkge1xuICAgICAgY29uc3QgdGVzdE1lc3NhZ2U6IENoYXRNZXNzYWdlID0ge1xuICAgICAgICBzZW5kZXJJZDogdXNlcklkLFxuICAgICAgICBzZW5kZXJOYW1lOiB1c2VyPy5uYW1lIHx8IFwiVGVzdCBVc2VyXCIsXG4gICAgICAgIHJlY2VpdmVySWQ6IFwidGVzdC1yZWNlaXZlclwiLFxuICAgICAgICBjb250ZW50OiBcIlRoaXMgaXMgYSB0ZXN0IG1lc3NhZ2UgYXQgXCIgKyBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpLFxuICAgICAgICBsaXN0aW5nSWQ6IFwidGVzdC1saXN0aW5nXCIsXG4gICAgICB9O1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIvCfp6ogU2VuZGluZyB0ZXN0IG1lc3NhZ2U6XCIsIHRlc3RNZXNzYWdlKTtcbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBzZW5kTWVzc2FnZSh0ZXN0TWVzc2FnZSk7XG4gICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBUZXN0IG1lc3NhZ2Ugc2VudCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEZhaWxlZCB0byBzZW5kIHRlc3QgbWVzc2FnZVwiKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBDYW5ub3Qgc2VuZCB0ZXN0IG1lc3NhZ2U6IG5vdCBjb25uZWN0ZWRcIik7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGhhbmRsZUtleVByZXNzID0gKGU6IFJlYWN0LktleWJvYXJkRXZlbnQpID0+IHtcbiAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIiAmJiAhZS5zaGlmdEtleSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaGFuZGxlU2VuZCgpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZXRDb25uZWN0aW9uU3RhdHVzVGV4dCA9ICgpID0+IHtcbiAgICBzd2l0Y2ggKGNvbm5lY3Rpb25TdGF0dXMpIHtcbiAgICAgIGNhc2UgXCJjb25uZWN0aW5nXCI6XG4gICAgICAgIHJldHVybiBcIkNvbm5lY3RpbmcgdG8gY2hhdC4uLlwiO1xuICAgICAgY2FzZSBcImNvbm5lY3RlZFwiOlxuICAgICAgICByZXR1cm4gXCJDb25uZWN0ZWRcIjtcbiAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICByZXR1cm4gXCJDb25uZWN0aW9uIEVycm9yXCI7XG4gICAgICBjYXNlIFwiZGlzY29ubmVjdGVkXCI6XG4gICAgICAgIHJldHVybiBcIkRpc2Nvbm5lY3RlZCAtIHRyeWluZyB0byByZWNvbm5lY3QuLi5cIjtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBcIlVua25vd24gc3RhdHVzXCI7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGdldENvbm5lY3Rpb25TdGF0dXNDb2xvciA9ICgpID0+IHtcbiAgICBzd2l0Y2ggKGNvbm5lY3Rpb25TdGF0dXMpIHtcbiAgICAgIGNhc2UgXCJjb25uZWN0aW5nXCI6XG4gICAgICAgIHJldHVybiBcInRleHQteWVsbG93LTUwMFwiO1xuICAgICAgY2FzZSBcImNvbm5lY3RlZFwiOlxuICAgICAgICByZXR1cm4gXCJ0ZXh0LWdyZWVuLTUwMFwiO1xuICAgICAgY2FzZSBcImVycm9yXCI6XG4gICAgICAgIHJldHVybiBcInRleHQtcmVkLTUwMFwiO1xuICAgICAgY2FzZSBcImRpc2Nvbm5lY3RlZFwiOlxuICAgICAgICByZXR1cm4gXCJ0ZXh0LXJlZC01MDBcIjtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBcInRleHQtZ3JheS01MDBcIjtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIm1heC13LTR4bCBteC1hdXRvIHB4LTQgcHktMTJcIj5cbiAgICAgIDxoMSBjbGFzc05hbWU9XCJ0ZXh0LTN4bCBmb250LWJvbGQgbWItNlwiPkNoYXQgVGVzdDwvaDE+XG4gICAgICBcbiAgICAgIHsvKiBEZWJ1ZyBDb25uZWN0aW9uIFN0YXR1cyAqL31cbiAgICAgIHtzaG93RGVidWcgJiYgKFxuICAgICAgICA8Q2hhdENvbm5lY3Rpb25TdGF0dXNcbiAgICAgICAgICBjb25uZWN0aW9uU3RhdHVzPXtjb25uZWN0aW9uU3RhdHVzfVxuICAgICAgICAgIGlzQ29ubmVjdGVkPXtpc0Nvbm5lY3RlZH1cbiAgICAgICAgICBpc0Nvbm5lY3Rpbmc9e2lzQ29ubmVjdGluZ31cbiAgICAgICAgICBoYXNFcnJvcj17aGFzRXJyb3J9XG4gICAgICAgICAgb25SZWNvbm5lY3Q9e3JlY29ubmVjdH1cbiAgICAgICAgLz5cbiAgICAgICl9XG4gICAgICBcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMSBsZzpncmlkLWNvbHMtMyBnYXAtNlwiPlxuICAgICAgICB7LyogQ2hhdCBDb25maWd1cmF0aW9uICovfVxuICAgICAgICA8Q2FyZCBjbGFzc05hbWU9XCJwLTRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBtYi00XCI+XG4gICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LXNlbWlib2xkXCI+Q2hhdCBTZXR0aW5nczwvaDI+XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgc2l6ZT1cInNtXCJcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2hvd0RlYnVnKCFzaG93RGVidWcpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7c2hvd0RlYnVnID8gXCJIaWRlXCIgOiBcIlNob3dcIn0gRGVidWdcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwiYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSBtYi0xXCI+WW91ciBJRDo8L2xhYmVsPlxuICAgICAgICAgICAgICA8SW5wdXQgdmFsdWU9e2lzQ2xpZW50ID8gdXNlcklkIDogXCJMb2FkaW5nLi4uXCJ9IGRpc2FibGVkIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIG1iLTFcIj5SZWNlaXZlciBJRDo8L2xhYmVsPlxuICAgICAgICAgICAgICA8SW5wdXQgXG4gICAgICAgICAgICAgICAgdmFsdWU9e3JlY2VpdmVySWR9IFxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0UmVjZWl2ZXJJZChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciByZWNlaXZlciBJRFwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIG1iLTFcIj5MaXN0aW5nIElEOjwvbGFiZWw+XG4gICAgICAgICAgICAgIDxJbnB1dCBcbiAgICAgICAgICAgICAgICB2YWx1ZT17bGlzdGluZ0lkfSBcbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldExpc3RpbmdJZChlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJFbnRlciBsaXN0aW5nIElEXCJcbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBzcGFjZS14LTJcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2B3LTMgaC0zIHJvdW5kZWQtZnVsbCAke1xuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25TdGF0dXMgPT09IFwiY29ubmVjdGVkXCIgPyBcImJnLWdyZWVuLTUwMFwiIDogXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvblN0YXR1cyA9PT0gXCJjb25uZWN0aW5nXCIgPyBcImJnLXllbGxvdy01MDBcIiA6IFxuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25TdGF0dXMgPT09IFwiZXJyb3JcIiA/IFwiYmctcmVkLTUwMFwiIDogXCJiZy1ncmF5LTUwMFwiXG4gICAgICAgICAgICAgIH1gfT48L2Rpdj5cbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPXtgdGV4dC1zbSAke2dldENvbm5lY3Rpb25TdGF0dXNDb2xvcigpfWB9PlxuICAgICAgICAgICAgICAgIHtnZXRDb25uZWN0aW9uU3RhdHVzVGV4dCgpfVxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIHtjb25uZWN0aW9uU3RhdHVzID09PSBcImVycm9yXCIgJiYgKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgICAgIHNpemU9XCJzbVwiXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXtyZWNvbm5lY3R9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGxcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIE1hbnVhbCBSZWNvbm5lY3RcbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB7LyogVGVzdCBCdXR0b24gKi99XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lXCJcbiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlVGVzdE1lc3NhZ2V9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXshaXNDb25uZWN0ZWR9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIFNlbmQgVGVzdCBNZXNzYWdlXG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgey8qIERlYnVnIEluZm8gKi99XG4gICAgICAgICAgICB7aXNDbGllbnQgJiYgKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm10LTQgcC0yIGJnLWdyYXktMTAwIHJvdW5kZWQgdGV4dC14c1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9udC1tZWRpdW0gbWItMVwiPkRlYnVnIEluZm86PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdj5NZXNzYWdlcyBjb3VudDoge2xvY2FsTWVzc2FnZXMubGVuZ3RofTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXY+Q29ubmVjdGlvbjoge2Nvbm5lY3Rpb25TdGF0dXN9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdj5Vc2VyIElEOiB7dXNlcklkfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXY+UmVjZWl2ZXIgSUQ6IHtyZWNlaXZlcklkfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXY+TGlzdGluZyBJRDoge2xpc3RpbmdJZH08L2Rpdj5cbiAgICAgICAgICAgICAgICB7bGFzdFJlY2VpdmVkTWVzc2FnZSAmJiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm10LTJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb250LW1lZGl1bVwiPkxhc3QgUmVjZWl2ZWQ6PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxwcmUgY2xhc3NOYW1lPVwidGV4dC14cyBiZy13aGl0ZSBwLTEgcm91bmRlZCBvdmVyZmxvdy1hdXRvIG1heC1oLTIwXCI+XG4gICAgICAgICAgICAgICAgICAgICAge2xhc3RSZWNlaXZlZE1lc3NhZ2V9XG4gICAgICAgICAgICAgICAgICAgIDwvcHJlPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0NhcmQ+XG5cbiAgICAgICAgey8qIENoYXQgTWVzc2FnZXMgKi99XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGc6Y29sLXNwYW4tMlwiPlxuICAgICAgICAgIDxDYXJkIGNsYXNzTmFtZT1cImgtOTYgZmxleCBmbGV4LWNvbFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgYm9yZGVyLWJcIj5cbiAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1zZW1pYm9sZFwiPk1lc3NhZ2VzPC9oMj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSBvdmVyZmxvdy15LWF1dG8gcC00IHNwYWNlLXktMlwiPlxuICAgICAgICAgICAgICB7bG9jYWxNZXNzYWdlcy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlciB0ZXh0LWdyYXktNTAwIHB5LThcIj5cbiAgICAgICAgICAgICAgICAgIHtjb25uZWN0aW9uU3RhdHVzID09PSBcImNvbm5lY3RlZFwiIFxuICAgICAgICAgICAgICAgICAgICA/IFwiTm8gbWVzc2FnZXMgeWV0LiBTdGFydCBhIGNvbnZlcnNhdGlvbiFcIlxuICAgICAgICAgICAgICAgICAgICA6IFwiQ29ubmVjdGluZyB0byBjaGF0IHNlcnZpY2UuLi5cIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgIGxvY2FsTWVzc2FnZXMubWFwKChtc2csIGlkeCkgPT4gKFxuICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICBrZXk9e21zZy5pZCB8fCBpZHh9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggJHtcbiAgICAgICAgICAgICAgICAgICAgICBtc2cuc2VuZGVySWQgPT09IHVzZXJJZCA/IFwianVzdGlmeS1lbmRcIiA6IFwianVzdGlmeS1zdGFydFwiXG4gICAgICAgICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgbWF4LXcteHMgcHgtMyBweS0yIHJvdW5kZWQtbGcgdGV4dC1zbSAke1xuICAgICAgICAgICAgICAgICAgICAgICAgbXNnLnNlbmRlcklkID09PSB1c2VySWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcImJnLWJsdWUtNTAwIHRleHQtd2hpdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiYmctZ3JheS0yMDAgdGV4dC1ncmF5LTgwMFwiXG4gICAgICAgICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQteHMgbWItMVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAge21zZy5zZW5kZXJOYW1lfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXY+e21zZy5jb250ZW50fTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIHttc2cudGltZXN0YW1wICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC14cyBvcGFjaXR5LTcwIG10LTFcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAge25ldyBEYXRlKG1zZy50aW1lc3RhbXApLnRvTG9jYWxlVGltZVN0cmluZygpfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC00IGJvcmRlci10XCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBzcGFjZS14LTJcIj5cbiAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgIHZhbHVlPXtpbnB1dH1cbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0SW5wdXQoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgICAgb25LZXlQcmVzcz17aGFuZGxlS2V5UHJlc3N9XG4gICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17XG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25TdGF0dXMgPT09IFwiY29ubmVjdGVkXCIgXG4gICAgICAgICAgICAgICAgICAgICAgPyBcIlR5cGUgeW91ciBtZXNzYWdlLi4uXCIgXG4gICAgICAgICAgICAgICAgICAgICAgOiBcIkNvbm5lY3RpbmcuLi5cIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0Nvbm5lY3RlZCB8fCBpc0Nvbm5lY3Rpbmd9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LTFcIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlU2VuZH1cbiAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshaW5wdXQudHJpbSgpIHx8ICFpc0Nvbm5lY3RlZCB8fCBpc0Nvbm5lY3Rpbmd9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgU2VuZFxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAge2Nvbm5lY3Rpb25TdGF0dXMgIT09IFwiY29ubmVjdGVkXCIgJiYgKFxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT17YHRleHQteHMgbXQtMSAke2dldENvbm5lY3Rpb25TdGF0dXNDb2xvcigpfWB9PlxuICAgICAgICAgICAgICAgICAge2dldENvbm5lY3Rpb25TdGF0dXNUZXh0KCl9XG4gICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9DYXJkPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuIl0sIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlU2VsZWN0b3IiLCJ1c2VDaGF0IiwiQnV0dG9uIiwiSW5wdXQiLCJDYXJkIiwiQ2hhdENvbm5lY3Rpb25TdGF0dXMiLCJDaGF0UGFnZSIsImxvY2FsTWVzc2FnZXMiLCJzZXRMb2NhbE1lc3NhZ2VzIiwiaW5wdXQiLCJzZXRJbnB1dCIsInJlY2VpdmVySWQiLCJzZXRSZWNlaXZlcklkIiwibGlzdGluZ0lkIiwic2V0TGlzdGluZ0lkIiwic2hvd0RlYnVnIiwic2V0U2hvd0RlYnVnIiwiaXNDbGllbnQiLCJzZXRJc0NsaWVudCIsImxhc3RSZWNlaXZlZE1lc3NhZ2UiLCJzZXRMYXN0UmVjZWl2ZWRNZXNzYWdlIiwidXNlciIsInN0YXRlIiwiYXV0aCIsInVzZXJJZCIsImlkIiwic2VuZE1lc3NhZ2UiLCJpc0Nvbm5lY3RlZCIsImlzQ29ubmVjdGluZyIsImhhc0Vycm9yIiwiY29ubmVjdGlvblN0YXR1cyIsInJlY29ubmVjdCIsImFkZE1lc3NhZ2VMaXN0ZW5lciIsInVuc3Vic2NyaWJlIiwibXNnIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcmV2IiwiaGFuZGxlU2VuZCIsInRyaW0iLCJtZXNzYWdlIiwic2VuZGVySWQiLCJzZW5kZXJOYW1lIiwibmFtZSIsImNvbnRlbnQiLCJzdWNjZXNzIiwiZXJyb3IiLCJmaWx0ZXIiLCJtIiwiaGFuZGxlVGVzdE1lc3NhZ2UiLCJ0ZXN0TWVzc2FnZSIsIkRhdGUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJoYW5kbGVLZXlQcmVzcyIsImUiLCJrZXkiLCJzaGlmdEtleSIsInByZXZlbnREZWZhdWx0IiwiZ2V0Q29ubmVjdGlvblN0YXR1c1RleHQiLCJnZXRDb25uZWN0aW9uU3RhdHVzQ29sb3IiLCJkaXYiLCJjbGFzc05hbWUiLCJoMSIsIm9uUmVjb25uZWN0IiwiaDIiLCJ2YXJpYW50Iiwic2l6ZSIsIm9uQ2xpY2siLCJsYWJlbCIsInZhbHVlIiwiZGlzYWJsZWQiLCJvbkNoYW5nZSIsInRhcmdldCIsInBsYWNlaG9sZGVyIiwic3BhbiIsImxlbmd0aCIsInByZSIsIm1hcCIsImlkeCIsInRpbWVzdGFtcCIsIm9uS2V5UHJlc3MiLCJwIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/app/chat/page.tsx\n"));

/***/ }),

/***/ "(app-pages-browser)/./src/contexts/ChatContext.tsx":
/*!**************************************!*\
  !*** ./src/contexts/ChatContext.tsx ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatProvider: () => (/* binding */ ChatProvider),\n/* harmony export */   useChat: () => (/* binding */ useChat)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/../../node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/../../node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var sockjs_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sockjs-client */ \"(app-pages-browser)/../../node_modules/sockjs-client/lib/entry.js\");\n/* harmony import */ var sockjs_client__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(sockjs_client__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _stomp_stompjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @stomp/stompjs */ \"(app-pages-browser)/../../node_modules/@stomp/stompjs/esm6/client.js\");\n/* __next_internal_client_entry_do_not_use__ ChatProvider,useChat auto */ \nvar _s = $RefreshSig$(), _s1 = $RefreshSig$();\n\n\n\nconst ChatContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null);\n// Global connection manager\nlet globalClient = null;\nlet globalConnectionState = \"disconnected\";\nlet messageListeners = new Set();\nlet processedMessages = new Set();\nfunction ChatProvider(param) {\n    let { children, userId } = param;\n    _s();\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [connectionState, setConnectionState] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"disconnected\");\n    const reconnectTimeoutRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const connectionAttemptsRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    const maxReconnectAttempts = 3;\n    const reconnectDelay = 3000;\n    const isConnectingRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    const updateConnectionState = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"ChatProvider.useCallback[updateConnectionState]\": (newState)=>{\n            globalConnectionState = newState;\n            setConnectionState(newState);\n        }\n    }[\"ChatProvider.useCallback[updateConnectionState]\"], []);\n    const addMessageListener = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"ChatProvider.useCallback[addMessageListener]\": (listener)=>{\n            messageListeners.add(listener);\n            return ({\n                \"ChatProvider.useCallback[addMessageListener]\": ()=>{\n                    messageListeners.delete(listener);\n                }\n            })[\"ChatProvider.useCallback[addMessageListener]\"];\n        }\n    }[\"ChatProvider.useCallback[addMessageListener]\"], []);\n    const notifyMessageListeners = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"ChatProvider.useCallback[notifyMessageListeners]\": (msg)=>{\n            messageListeners.forEach({\n                \"ChatProvider.useCallback[notifyMessageListeners]\": (listener)=>{\n                    try {\n                        listener(msg);\n                    } catch (error) {\n                        console.error(\"Error in message listener:\", error);\n                    }\n                }\n            }[\"ChatProvider.useCallback[notifyMessageListeners]\"]);\n        }\n    }[\"ChatProvider.useCallback[notifyMessageListeners]\"], []);\n    const connect = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"ChatProvider.useCallback[connect]\": ()=>{\n            if (!userId || isConnectingRef.current) return;\n            // Check if there's already a global connection\n            if (globalClient && globalClient.connected) {\n                console.log(\"🔌 Using existing global WebSocket connection for user:\", userId);\n                updateConnectionState(\"connected\");\n                return;\n            }\n            // Clean up any existing connection\n            if (globalClient) {\n                try {\n                    globalClient.deactivate();\n                } catch (error) {\n                    console.warn(\"Error deactivating existing global client:\", error);\n                }\n                globalClient = null;\n            }\n            if (reconnectTimeoutRef.current) {\n                clearTimeout(reconnectTimeoutRef.current);\n                reconnectTimeoutRef.current = null;\n            }\n            connectionAttemptsRef.current = 0;\n            isConnectingRef.current = true;\n            console.log(\"🔌 Initializing global WebSocket connection for user:\", userId);\n            updateConnectionState(\"connecting\");\n            try {\n                const socket = new (sockjs_client__WEBPACK_IMPORTED_MODULE_2___default())(\"http://localhost:8081/ws\");\n                const client = new _stomp_stompjs__WEBPACK_IMPORTED_MODULE_3__.Client({\n                    webSocketFactory: {\n                        \"ChatProvider.useCallback[connect]\": ()=>socket\n                    }[\"ChatProvider.useCallback[connect]\"],\n                    reconnectDelay: 0,\n                    heartbeatIncoming: 4000,\n                    heartbeatOutgoing: 4000,\n                    onConnect: {\n                        \"ChatProvider.useCallback[connect]\": ()=>{\n                            console.log(\"✅ Global WebSocket connected successfully for user:\", userId);\n                            connectionAttemptsRef.current = 0;\n                            isConnectingRef.current = false;\n                            updateConnectionState(\"connected\");\n                            globalClient = client;\n                            // Subscribe to user-specific private messages\n                            client.subscribe(\"/user/\".concat(userId, \"/queue/messages\"), {\n                                \"ChatProvider.useCallback[connect]\": (message)=>{\n                                    try {\n                                        console.log(\"📨 Received private message for user\", userId, \":\", message.body);\n                                        const body = JSON.parse(message.body);\n                                        console.log(\"📨 Parsed private message:\", body);\n                                        // Only process if it's a chat message (not join message)\n                                        if (body.content && body.content !== \"joined\") {\n                                            // Create a unique key for message deduplication\n                                            const messageKey = \"\".concat(body.id || body.timestamp || Date.now(), \"_\").concat(body.senderId, \"_\").concat(body.content);\n                                            if (processedMessages.has(messageKey)) {\n                                                console.log(\"📨 Skipping duplicate message:\", messageKey);\n                                                return;\n                                            }\n                                            processedMessages.add(messageKey);\n                                            // Clean up old messages from the set (keep only last 100)\n                                            if (processedMessages.size > 100) {\n                                                const messagesArray = Array.from(processedMessages);\n                                                processedMessages.clear();\n                                                messagesArray.slice(-50).forEach({\n                                                    \"ChatProvider.useCallback[connect]\": (msg)=>processedMessages.add(msg)\n                                                }[\"ChatProvider.useCallback[connect]\"]);\n                                            }\n                                            console.log(\"📨 Processing private message\");\n                                            setMessages({\n                                                \"ChatProvider.useCallback[connect]\": (prev)=>[\n                                                        ...prev,\n                                                        body\n                                                    ]\n                                            }[\"ChatProvider.useCallback[connect]\"]);\n                                            notifyMessageListeners(body);\n                                        } else {\n                                            console.log(\"📨 Ignoring join message\");\n                                        }\n                                    } catch (error) {\n                                        console.error(\"❌ Error parsing private message:\", error);\n                                    }\n                                }\n                            }[\"ChatProvider.useCallback[connect]\"]);\n                            // Send join message only once per connection\n                            const joinMessage = {\n                                senderId: userId,\n                                senderName: userId,\n                                content: \"joined\",\n                                receiverId: \"\",\n                                listingId: \"\"\n                            };\n                            console.log(\"👋 Sending join message:\", joinMessage);\n                            client.publish({\n                                destination: \"/app/chat.join\",\n                                body: JSON.stringify(joinMessage)\n                            });\n                        }\n                    }[\"ChatProvider.useCallback[connect]\"],\n                    onDisconnect: {\n                        \"ChatProvider.useCallback[connect]\": ()=>{\n                            console.log(\"❌ Global WebSocket disconnected for user:\", userId);\n                            isConnectingRef.current = false;\n                            updateConnectionState(\"disconnected\");\n                            globalClient = null;\n                            // Attempt to reconnect if we haven't exceeded max attempts\n                            if (connectionAttemptsRef.current < maxReconnectAttempts) {\n                                connectionAttemptsRef.current++;\n                                console.log(\"\\uD83D\\uDD04 Reconnection attempt \".concat(connectionAttemptsRef.current, \"/\").concat(maxReconnectAttempts, \" for user:\"), userId);\n                                reconnectTimeoutRef.current = setTimeout({\n                                    \"ChatProvider.useCallback[connect]\": ()=>{\n                                        connect();\n                                    }\n                                }[\"ChatProvider.useCallback[connect]\"], reconnectDelay);\n                            } else {\n                                console.error(\"❌ Max reconnection attempts reached for user:\", userId);\n                                updateConnectionState(\"error\");\n                            }\n                        }\n                    }[\"ChatProvider.useCallback[connect]\"],\n                    onStompError: {\n                        \"ChatProvider.useCallback[connect]\": (error)=>{\n                            console.error(\"❌ STOMP error for user\", userId, \":\", error);\n                            isConnectingRef.current = false;\n                            updateConnectionState(\"error\");\n                        }\n                    }[\"ChatProvider.useCallback[connect]\"],\n                    onWebSocketError: {\n                        \"ChatProvider.useCallback[connect]\": (error)=>{\n                            console.error(\"❌ WebSocket error for user\", userId, \":\", error);\n                            isConnectingRef.current = false;\n                            updateConnectionState(\"error\");\n                        }\n                    }[\"ChatProvider.useCallback[connect]\"],\n                    onWebSocketClose: {\n                        \"ChatProvider.useCallback[connect]\": ()=>{\n                            console.log(\"❌ Global WebSocket connection closed for user:\", userId);\n                            isConnectingRef.current = false;\n                            updateConnectionState(\"disconnected\");\n                        }\n                    }[\"ChatProvider.useCallback[connect]\"]\n                });\n                client.activate();\n            } catch (error) {\n                console.error(\"❌ Error creating global WebSocket connection for user\", userId, \":\", error);\n                isConnectingRef.current = false;\n                updateConnectionState(\"error\");\n            }\n        }\n    }[\"ChatProvider.useCallback[connect]\"], [\n        userId,\n        updateConnectionState,\n        notifyMessageListeners\n    ]);\n    const sendMessage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"ChatProvider.useCallback[sendMessage]\": (msg)=>{\n            if (connectionState !== \"connected\" || !globalClient) {\n                console.error(\"❌ Cannot send message: not connected. State:\", connectionState);\n                return false;\n            }\n            try {\n                console.log(\"📤 Sending private message via global WebSocket:\", msg);\n                globalClient.publish({\n                    destination: \"/app/chat.private\",\n                    body: JSON.stringify(msg)\n                });\n                console.log(\"✅ Private message sent successfully via global WebSocket\");\n                return true;\n            } catch (error) {\n                console.error(\"❌ Error sending private message via global WebSocket:\", error);\n                return false;\n            }\n        }\n    }[\"ChatProvider.useCallback[sendMessage]\"], [\n        connectionState\n    ]);\n    const reconnect = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"ChatProvider.useCallback[reconnect]\": ()=>{\n            console.log(\"🔄 Manual reconnect requested for user:\", userId);\n            connectionAttemptsRef.current = 0;\n            isConnectingRef.current = false;\n            // Clean up existing connection\n            if (globalClient) {\n                try {\n                    globalClient.deactivate();\n                } catch (error) {\n                    console.warn(\"Error deactivating global client during manual reconnect:\", error);\n                }\n                globalClient = null;\n            }\n            if (reconnectTimeoutRef.current) {\n                clearTimeout(reconnectTimeoutRef.current);\n                reconnectTimeoutRef.current = null;\n            }\n            connect();\n        }\n    }[\"ChatProvider.useCallback[reconnect]\"], [\n        userId,\n        connect\n    ]);\n    // Initialize connection when userId changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"ChatProvider.useEffect\": ()=>{\n            if (userId) {\n                connect();\n            } else {\n                updateConnectionState(\"disconnected\");\n            }\n            return ({\n                \"ChatProvider.useEffect\": ()=>{\n                    if (reconnectTimeoutRef.current) {\n                        clearTimeout(reconnectTimeoutRef.current);\n                    }\n                }\n            })[\"ChatProvider.useEffect\"];\n        }\n    }[\"ChatProvider.useEffect\"], [\n        userId,\n        connect,\n        updateConnectionState\n    ]);\n    const isConnected = connectionState === \"connected\";\n    const isConnecting = connectionState === \"connecting\";\n    const hasError = connectionState === \"error\";\n    const contextValue = {\n        messages,\n        sendMessage,\n        isConnected,\n        isConnecting,\n        hasError,\n        connectionStatus: connectionState,\n        reconnect,\n        addMessageListener\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ChatContext.Provider, {\n        value: contextValue,\n        children: children\n    }, void 0, false, {\n        fileName: \"/Users/nihal/Desktop/Nihal/Projects/listri/apps/frontend/src/contexts/ChatContext.tsx\",\n        lineNumber: 288,\n        columnNumber: 5\n    }, this);\n}\n_s(ChatProvider, \"4oKLfQnyD9prkbVAW9bL6EmZx5Q=\");\n_c = ChatProvider;\nfunction useChat() {\n    _s1();\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(ChatContext);\n    if (!context) {\n        throw new Error(\"useChat must be used within a ChatProvider\");\n    }\n    return context;\n}\n_s1(useChat, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"ChatProvider\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb250ZXh0cy9DaGF0Q29udGV4dC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUVtRztBQUNoRTtBQUNLO0FBMEJ4QyxNQUFNUyw0QkFBY1Isb0RBQWFBLENBQXlCO0FBRTFELDRCQUE0QjtBQUM1QixJQUFJUyxlQUE4QjtBQUNsQyxJQUFJQyx3QkFBeUM7QUFDN0MsSUFBSUMsbUJBQW9ELElBQUlDO0FBQzVELElBQUlDLG9CQUFvQixJQUFJRDtBQUVyQixTQUFTRSxhQUFhLEtBQW1FO1FBQW5FLEVBQUVDLFFBQVEsRUFBRUMsTUFBTSxFQUFpRCxHQUFuRTs7SUFDM0IsTUFBTSxDQUFDQyxVQUFVQyxZQUFZLEdBQUdmLCtDQUFRQSxDQUFnQixFQUFFO0lBQzFELE1BQU0sQ0FBQ2dCLGlCQUFpQkMsbUJBQW1CLEdBQUdqQiwrQ0FBUUEsQ0FBa0I7SUFDeEUsTUFBTWtCLHNCQUFzQmpCLDZDQUFNQSxDQUF3QjtJQUMxRCxNQUFNa0Isd0JBQXdCbEIsNkNBQU1BLENBQUM7SUFDckMsTUFBTW1CLHVCQUF1QjtJQUM3QixNQUFNQyxpQkFBaUI7SUFDdkIsTUFBTUMsa0JBQWtCckIsNkNBQU1BLENBQUM7SUFFL0IsTUFBTXNCLHdCQUF3QnJCLGtEQUFXQTsyREFBQyxDQUFDc0I7WUFDekNqQix3QkFBd0JpQjtZQUN4QlAsbUJBQW1CTztRQUNyQjswREFBRyxFQUFFO0lBRUwsTUFBTUMscUJBQXFCdkIsa0RBQVdBO3dEQUFDLENBQUN3QjtZQUN0Q2xCLGlCQUFpQm1CLEdBQUcsQ0FBQ0Q7WUFDckI7Z0VBQU87b0JBQ0xsQixpQkFBaUJvQixNQUFNLENBQUNGO2dCQUMxQjs7UUFDRjt1REFBRyxFQUFFO0lBRUwsTUFBTUcseUJBQXlCM0Isa0RBQVdBOzREQUFDLENBQUM0QjtZQUMxQ3RCLGlCQUFpQnVCLE9BQU87b0VBQUNMLENBQUFBO29CQUN2QixJQUFJO3dCQUNGQSxTQUFTSTtvQkFDWCxFQUFFLE9BQU9FLE9B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QUlZLG9CQUFvQmlCLE9BQU8sRUFBRTtnQkFDL0JLLGFBQWF0QixvQkFBb0JpQixPQUFPO2dCQUN4Q2pCLG9CQUFvQmlCLE9BQU8sR0FBRztZQUNoQztZQUVBRDtRQUNGOzhDQUFHO1FBQUNyQjtRQUFRcUI7S0FBUTtJQUVwQiw0Q0FBNEM7SUFDNUNuQyxnREFBU0E7a0NBQUM7WUFDUixJQUFJYyxRQUFRO2dCQUNWcUI7WUFDRixPQUFPO2dCQUNMWCxzQkFBc0I7WUFDeEI7WUFFQTswQ0FBTztvQkFDTCxJQUFJTCxvQkFBb0JpQixPQUFPLEVBQUU7d0JBQy9CSyxhQUFhdEIsb0JBQW9CaUIsT0FBTztvQkFDMUM7Z0JBQ0Y7O1FBQ0Y7aUNBQUc7UUFBQ3RCO1FBQVFxQjtRQUFTWDtLQUFzQjtJQUUzQyxNQUFNMkQsY0FBY2xFLG9CQUFvQjtJQUN4QyxNQUFNbUUsZUFBZW5FLG9CQUFvQjtJQUN6QyxNQUFNb0UsV0FBV3BFLG9CQUFvQjtJQUVyQyxNQUFNcUUsZUFBZ0M7UUFDcEN2RTtRQUNBa0U7UUFDQUU7UUFDQUM7UUFDQUM7UUFDQUUsa0JBQWtCdEU7UUFDbEJpRTtRQUNBeEQ7SUFDRjtJQUVBLHFCQUNFLDhEQUFDcEIsWUFBWWtGLFFBQVE7UUFBQ0MsT0FBT0g7a0JBQzFCekU7Ozs7OztBQUdQO0dBN1BnQkQ7S0FBQUE7QUErUFQsU0FBUzhFOztJQUNkLE1BQU1DLFVBQVU1RixpREFBVUEsQ0FBQ087SUFDM0IsSUFBSSxDQUFDcUYsU0FBUztRQUNaLE1BQU0sSUFBSUMsTUFBTTtJQUNsQjtJQUNBLE9BQU9EO0FBQ1Q7SUFOZ0JEIiwic291cmNlcyI6WyIvVXNlcnMvbmloYWwvRGVza3RvcC9OaWhhbC9Qcm9qZWN0cy9saXN0cmkvYXBwcy9mcm9udGVuZC9zcmMvY29udGV4dHMvQ2hhdENvbnRleHQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgUmVhY3QsIHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VDYWxsYmFjayB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFNvY2tKUyBmcm9tIFwic29ja2pzLWNsaWVudFwiO1xuaW1wb3J0IHsgQ2xpZW50IH0gZnJvbSBcIkBzdG9tcC9zdG9tcGpzXCI7XG5cbmV4cG9ydCB0eXBlIENoYXRNZXNzYWdlID0ge1xuICBpZD86IHN0cmluZztcbiAgY29udmVyc2F0aW9uSWQ/OiBzdHJpbmc7XG4gIHNlbmRlcklkOiBzdHJpbmc7XG4gIHNlbmRlck5hbWU6IHN0cmluZztcbiAgcmVjZWl2ZXJJZDogc3RyaW5nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHRpbWVzdGFtcD86IHN0cmluZztcbiAgbGlzdGluZ0lkOiBzdHJpbmc7XG59O1xuXG50eXBlIENvbm5lY3Rpb25TdGF0ZSA9IFwiZGlzY29ubmVjdGVkXCIgfCBcImNvbm5lY3RpbmdcIiB8IFwiY29ubmVjdGVkXCIgfCBcImVycm9yXCI7XG5cbmludGVyZmFjZSBDaGF0Q29udGV4dFR5cGUge1xuICBtZXNzYWdlczogQ2hhdE1lc3NhZ2VbXTtcbiAgc2VuZE1lc3NhZ2U6IChtc2c6IENoYXRNZXNzYWdlKSA9PiBib29sZWFuO1xuICBpc0Nvbm5lY3RlZDogYm9vbGVhbjtcbiAgaXNDb25uZWN0aW5nOiBib29sZWFuO1xuICBoYXNFcnJvcjogYm9vbGVhbjtcbiAgY29ubmVjdGlvblN0YXR1czogQ29ubmVjdGlvblN0YXRlO1xuICByZWNvbm5lY3Q6ICgpID0+IHZvaWQ7XG4gIGFkZE1lc3NhZ2VMaXN0ZW5lcjogKGxpc3RlbmVyOiAobXNnOiBDaGF0TWVzc2FnZSkgPT4gdm9pZCkgPT4gKCkgPT4gdm9pZDtcbn1cblxuY29uc3QgQ2hhdENvbnRleHQgPSBjcmVhdGVDb250ZXh0PENoYXRDb250ZXh0VHlwZSB8IG51bGw+KG51bGwpO1xuXG4vLyBHbG9iYWwgY29ubmVjdGlvbiBtYW5hZ2VyXG5sZXQgZ2xvYmFsQ2xpZW50OiBDbGllbnQgfCBudWxsID0gbnVsbDtcbmxldCBnbG9iYWxDb25uZWN0aW9uU3RhdGU6IENvbm5lY3Rpb25TdGF0ZSA9IFwiZGlzY29ubmVjdGVkXCI7XG5sZXQgbWVzc2FnZUxpc3RlbmVyczogU2V0PChtc2c6IENoYXRNZXNzYWdlKSA9PiB2b2lkPiA9IG5ldyBTZXQoKTtcbmxldCBwcm9jZXNzZWRNZXNzYWdlcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG5leHBvcnQgZnVuY3Rpb24gQ2hhdFByb3ZpZGVyKHsgY2hpbGRyZW4sIHVzZXJJZCB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7IHVzZXJJZDogc3RyaW5nIH0pIHtcbiAgY29uc3QgW21lc3NhZ2VzLCBzZXRNZXNzYWdlc10gPSB1c2VTdGF0ZTxDaGF0TWVzc2FnZVtdPihbXSk7XG4gIGNvbnN0IFtjb25uZWN0aW9uU3RhdGUsIHNldENvbm5lY3Rpb25TdGF0ZV0gPSB1c2VTdGF0ZTxDb25uZWN0aW9uU3RhdGU+KFwiZGlzY29ubmVjdGVkXCIpO1xuICBjb25zdCByZWNvbm5lY3RUaW1lb3V0UmVmID0gdXNlUmVmPE5vZGVKUy5UaW1lb3V0IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGNvbm5lY3Rpb25BdHRlbXB0c1JlZiA9IHVzZVJlZigwKTtcbiAgY29uc3QgbWF4UmVjb25uZWN0QXR0ZW1wdHMgPSAzO1xuICBjb25zdCByZWNvbm5lY3REZWxheSA9IDMwMDA7XG4gIGNvbnN0IGlzQ29ubmVjdGluZ1JlZiA9IHVzZVJlZihmYWxzZSk7XG5cbiAgY29uc3QgdXBkYXRlQ29ubmVjdGlvblN0YXRlID0gdXNlQ2FsbGJhY2soKG5ld1N0YXRlOiBDb25uZWN0aW9uU3RhdGUpID0+IHtcbiAgICBnbG9iYWxDb25uZWN0aW9uU3RhdGUgPSBuZXdTdGF0ZTtcbiAgICBzZXRDb25uZWN0aW9uU3RhdGUobmV3U3RhdGUpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgYWRkTWVzc2FnZUxpc3RlbmVyID0gdXNlQ2FsbGJhY2soKGxpc3RlbmVyOiAobXNnOiBDaGF0TWVzc2FnZSkgPT4gdm9pZCkgPT4ge1xuICAgIG1lc3NhZ2VMaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbWVzc2FnZUxpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xuICAgIH07XG4gIH0sIFtdKTtcblxuICBjb25zdCBub3RpZnlNZXNzYWdlTGlzdGVuZXJzID0gdXNlQ2FsbGJhY2soKG1zZzogQ2hhdE1lc3NhZ2UpID0+IHtcbiAgICBtZXNzYWdlTGlzdGVuZXJzLmZvckVhY2gobGlzdGVuZXIgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgbGlzdGVuZXIobXNnKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBtZXNzYWdlIGxpc3RlbmVyOlwiLCBlcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sIFtdKTtcblxuICBjb25zdCBjb25uZWN0ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGlmICghdXNlcklkIHx8IGlzQ29ubmVjdGluZ1JlZi5jdXJyZW50KSByZXR1cm47XG5cbiAgICAvLyBDaGVjayBpZiB0aGVyZSdzIGFscmVhZHkgYSBnbG9iYWwgY29ubmVjdGlvblxuICAgIGlmIChnbG9iYWxDbGllbnQgJiYgZ2xvYmFsQ2xpZW50LmNvbm5lY3RlZCkge1xuICAgICAgY29uc29sZS5sb2coXCLwn5SMIFVzaW5nIGV4aXN0aW5nIGdsb2JhbCBXZWJTb2NrZXQgY29ubmVjdGlvbiBmb3IgdXNlcjpcIiwgdXNlcklkKTtcbiAgICAgIHVwZGF0ZUNvbm5lY3Rpb25TdGF0ZShcImNvbm5lY3RlZFwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDbGVhbiB1cCBhbnkgZXhpc3RpbmcgY29ubmVjdGlvblxuICAgIGlmIChnbG9iYWxDbGllbnQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGdsb2JhbENsaWVudC5kZWFjdGl2YXRlKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJFcnJvciBkZWFjdGl2YXRpbmcgZXhpc3RpbmcgZ2xvYmFsIGNsaWVudDpcIiwgZXJyb3IpO1xuICAgICAgfVxuICAgICAgZ2xvYmFsQ2xpZW50ID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAocmVjb25uZWN0VGltZW91dFJlZi5jdXJyZW50KSB7XG4gICAgICBjbGVhclRpbWVvdXQocmVjb25uZWN0VGltZW91dFJlZi5jdXJyZW50KTtcbiAgICAgIHJlY29ubmVjdFRpbWVvdXRSZWYuY3VycmVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgY29ubmVjdGlvbkF0dGVtcHRzUmVmLmN1cnJlbnQgPSAwO1xuICAgIGlzQ29ubmVjdGluZ1JlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhcIvCflIwgSW5pdGlhbGl6aW5nIGdsb2JhbCBXZWJTb2NrZXQgY29ubmVjdGlvbiBmb3IgdXNlcjpcIiwgdXNlcklkKTtcbiAgICB1cGRhdGVDb25uZWN0aW9uU3RhdGUoXCJjb25uZWN0aW5nXCIpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNvY2tldCA9IG5ldyBTb2NrSlMoXCJodHRwOi8vbG9jYWxob3N0OjgwODEvd3NcIik7XG4gICAgICBcbiAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBDbGllbnQoe1xuICAgICAgICB3ZWJTb2NrZXRGYWN0b3J5OiAoKSA9PiBzb2NrZXQsXG4gICAgICAgIHJlY29ubmVjdERlbGF5OiAwLCAvLyBEaXNhYmxlIGF1dG9tYXRpYyByZWNvbm5lY3Rpb25cbiAgICAgICAgaGVhcnRiZWF0SW5jb21pbmc6IDQwMDAsXG4gICAgICAgIGhlYXJ0YmVhdE91dGdvaW5nOiA0MDAwLFxuICAgICAgICBvbkNvbm5lY3Q6ICgpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBHbG9iYWwgV2ViU29ja2V0IGNvbm5lY3RlZCBzdWNjZXNzZnVsbHkgZm9yIHVzZXI6XCIsIHVzZXJJZCk7XG4gICAgICAgICAgY29ubmVjdGlvbkF0dGVtcHRzUmVmLmN1cnJlbnQgPSAwO1xuICAgICAgICAgIGlzQ29ubmVjdGluZ1JlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgdXBkYXRlQ29ubmVjdGlvblN0YXRlKFwiY29ubmVjdGVkXCIpO1xuICAgICAgICAgIFxuICAgICAgICAgIGdsb2JhbENsaWVudCA9IGNsaWVudDtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTdWJzY3JpYmUgdG8gdXNlci1zcGVjaWZpYyBwcml2YXRlIG1lc3NhZ2VzXG4gICAgICAgICAgY2xpZW50LnN1YnNjcmliZShgL3VzZXIvJHt1c2VySWR9L3F1ZXVlL21lc3NhZ2VzYCwgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+TqCBSZWNlaXZlZCBwcml2YXRlIG1lc3NhZ2UgZm9yIHVzZXJcIiwgdXNlcklkLCBcIjpcIiwgbWVzc2FnZS5ib2R5KTtcbiAgICAgICAgICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UobWVzc2FnZS5ib2R5KTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5OoIFBhcnNlZCBwcml2YXRlIG1lc3NhZ2U6XCIsIGJvZHkpO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgLy8gT25seSBwcm9jZXNzIGlmIGl0J3MgYSBjaGF0IG1lc3NhZ2UgKG5vdCBqb2luIG1lc3NhZ2UpXG4gICAgICAgICAgICAgIGlmIChib2R5LmNvbnRlbnQgJiYgYm9keS5jb250ZW50ICE9PSBcImpvaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgdW5pcXVlIGtleSBmb3IgbWVzc2FnZSBkZWR1cGxpY2F0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZUtleSA9IGAke2JvZHkuaWQgfHwgYm9keS50aW1lc3RhbXAgfHwgRGF0ZS5ub3coKX1fJHtib2R5LnNlbmRlcklkfV8ke2JvZHkuY29udGVudH1gO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzZWRNZXNzYWdlcy5oYXMobWVzc2FnZUtleSkpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+TqCBTa2lwcGluZyBkdXBsaWNhdGUgbWVzc2FnZTpcIiwgbWVzc2FnZUtleSk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZE1lc3NhZ2VzLmFkZChtZXNzYWdlS2V5KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cCBvbGQgbWVzc2FnZXMgZnJvbSB0aGUgc2V0IChrZWVwIG9ubHkgbGFzdCAxMDApXG4gICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NlZE1lc3NhZ2VzLnNpemUgPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VzQXJyYXkgPSBBcnJheS5mcm9tKHByb2Nlc3NlZE1lc3NhZ2VzKTtcbiAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZE1lc3NhZ2VzLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICBtZXNzYWdlc0FycmF5LnNsaWNlKC01MCkuZm9yRWFjaChtc2cgPT4gcHJvY2Vzc2VkTWVzc2FnZXMuYWRkKG1zZykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIvCfk6ggUHJvY2Vzc2luZyBwcml2YXRlIG1lc3NhZ2VcIik7XG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgYm9keV0pO1xuICAgICAgICAgICAgICAgIG5vdGlmeU1lc3NhZ2VMaXN0ZW5lcnMoYm9keSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5OoIElnbm9yaW5nIGpvaW4gbWVzc2FnZVwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBwYXJzaW5nIHByaXZhdGUgbWVzc2FnZTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gU2VuZCBqb2luIG1lc3NhZ2Ugb25seSBvbmNlIHBlciBjb25uZWN0aW9uXG4gICAgICAgICAgY29uc3Qgam9pbk1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBzZW5kZXJJZDogdXNlcklkLFxuICAgICAgICAgICAgc2VuZGVyTmFtZTogdXNlcklkLFxuICAgICAgICAgICAgY29udGVudDogXCJqb2luZWRcIixcbiAgICAgICAgICAgIHJlY2VpdmVySWQ6IFwiXCIsXG4gICAgICAgICAgICBsaXN0aW5nSWQ6IFwiXCJcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+RiyBTZW5kaW5nIGpvaW4gbWVzc2FnZTpcIiwgam9pbk1lc3NhZ2UpO1xuICAgICAgICAgIGNsaWVudC5wdWJsaXNoKHtcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBcIi9hcHAvY2hhdC5qb2luXCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShqb2luTWVzc2FnZSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRGlzY29ubmVjdDogKCkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwi4p2MIEdsb2JhbCBXZWJTb2NrZXQgZGlzY29ubmVjdGVkIGZvciB1c2VyOlwiLCB1c2VySWQpO1xuICAgICAgICAgIGlzQ29ubmVjdGluZ1JlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgdXBkYXRlQ29ubmVjdGlvblN0YXRlKFwiZGlzY29ubmVjdGVkXCIpO1xuICAgICAgICAgIFxuICAgICAgICAgIGdsb2JhbENsaWVudCA9IG51bGw7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQXR0ZW1wdCB0byByZWNvbm5lY3QgaWYgd2UgaGF2ZW4ndCBleGNlZWRlZCBtYXggYXR0ZW1wdHNcbiAgICAgICAgICBpZiAoY29ubmVjdGlvbkF0dGVtcHRzUmVmLmN1cnJlbnQgPCBtYXhSZWNvbm5lY3RBdHRlbXB0cykge1xuICAgICAgICAgICAgY29ubmVjdGlvbkF0dGVtcHRzUmVmLmN1cnJlbnQrKztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFJlY29ubmVjdGlvbiBhdHRlbXB0ICR7Y29ubmVjdGlvbkF0dGVtcHRzUmVmLmN1cnJlbnR9LyR7bWF4UmVjb25uZWN0QXR0ZW1wdHN9IGZvciB1c2VyOmAsIHVzZXJJZCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlY29ubmVjdFRpbWVvdXRSZWYuY3VycmVudCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBjb25uZWN0KCk7XG4gICAgICAgICAgICB9LCByZWNvbm5lY3REZWxheSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgTWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0cyByZWFjaGVkIGZvciB1c2VyOlwiLCB1c2VySWQpO1xuICAgICAgICAgICAgdXBkYXRlQ29ubmVjdGlvblN0YXRlKFwiZXJyb3JcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvblN0b21wRXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgU1RPTVAgZXJyb3IgZm9yIHVzZXJcIiwgdXNlcklkLCBcIjpcIiwgZXJyb3IpO1xuICAgICAgICAgIGlzQ29ubmVjdGluZ1JlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICAgICAgdXBkYXRlQ29ubmVjdGlvblN0YXRlKFwiZXJyb3JcIik7XG4gICAgICAgIH0sXG4gICAgICAgIG9uV2ViU29ja2V0RXJyb3I6IChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgV2ViU29ja2V0IGVycm9yIGZvciB1c2VyXCIsIHVzZXJJZCwgXCI6XCIsIGVycm9yKTtcbiAgICAgICAgICBpc0Nvbm5lY3RpbmdSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb25TdGF0ZShcImVycm9yXCIpO1xuICAgICAgICB9LFxuICAgICAgICBvbldlYlNvY2tldENsb3NlOiAoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCLinYwgR2xvYmFsIFdlYlNvY2tldCBjb25uZWN0aW9uIGNsb3NlZCBmb3IgdXNlcjpcIiwgdXNlcklkKTtcbiAgICAgICAgICBpc0Nvbm5lY3RpbmdSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgICAgICAgIHVwZGF0ZUNvbm5lY3Rpb25TdGF0ZShcImRpc2Nvbm5lY3RlZFwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGNsaWVudC5hY3RpdmF0ZSgpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRXJyb3IgY3JlYXRpbmcgZ2xvYmFsIFdlYlNvY2tldCBjb25uZWN0aW9uIGZvciB1c2VyXCIsIHVzZXJJZCwgXCI6XCIsIGVycm9yKTtcbiAgICAgIGlzQ29ubmVjdGluZ1JlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICB1cGRhdGVDb25uZWN0aW9uU3RhdGUoXCJlcnJvclwiKTtcbiAgICB9XG4gIH0sIFt1c2VySWQsIHVwZGF0ZUNvbm5lY3Rpb25TdGF0ZSwgbm90aWZ5TWVzc2FnZUxpc3RlbmVyc10pO1xuXG4gIGNvbnN0IHNlbmRNZXNzYWdlID0gdXNlQ2FsbGJhY2soKG1zZzogQ2hhdE1lc3NhZ2UpOiBib29sZWFuID0+IHtcbiAgICBpZiAoY29ubmVjdGlvblN0YXRlICE9PSBcImNvbm5lY3RlZFwiIHx8ICFnbG9iYWxDbGllbnQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgQ2Fubm90IHNlbmQgbWVzc2FnZTogbm90IGNvbm5lY3RlZC4gU3RhdGU6XCIsIGNvbm5lY3Rpb25TdGF0ZSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+TpCBTZW5kaW5nIHByaXZhdGUgbWVzc2FnZSB2aWEgZ2xvYmFsIFdlYlNvY2tldDpcIiwgbXNnKTtcbiAgICAgIGdsb2JhbENsaWVudC5wdWJsaXNoKHtcbiAgICAgICAgZGVzdGluYXRpb246IFwiL2FwcC9jaGF0LnByaXZhdGVcIixcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobXNnKSxcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coXCLinIUgUHJpdmF0ZSBtZXNzYWdlIHNlbnQgc3VjY2Vzc2Z1bGx5IHZpYSBnbG9iYWwgV2ViU29ja2V0XCIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRXJyb3Igc2VuZGluZyBwcml2YXRlIG1lc3NhZ2UgdmlhIGdsb2JhbCBXZWJTb2NrZXQ6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sIFtjb25uZWN0aW9uU3RhdGVdKTtcblxuICBjb25zdCByZWNvbm5lY3QgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCLwn5SEIE1hbnVhbCByZWNvbm5lY3QgcmVxdWVzdGVkIGZvciB1c2VyOlwiLCB1c2VySWQpO1xuICAgIGNvbm5lY3Rpb25BdHRlbXB0c1JlZi5jdXJyZW50ID0gMDtcbiAgICBpc0Nvbm5lY3RpbmdSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgIFxuICAgIC8vIENsZWFuIHVwIGV4aXN0aW5nIGNvbm5lY3Rpb25cbiAgICBpZiAoZ2xvYmFsQ2xpZW50KSB7XG4gICAgICB0cnkge1xuICAgICAgICBnbG9iYWxDbGllbnQuZGVhY3RpdmF0ZSgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiRXJyb3IgZGVhY3RpdmF0aW5nIGdsb2JhbCBjbGllbnQgZHVyaW5nIG1hbnVhbCByZWNvbm5lY3Q6XCIsIGVycm9yKTtcbiAgICAgIH1cbiAgICAgIGdsb2JhbENsaWVudCA9IG51bGw7XG4gICAgfVxuICAgIFxuICAgIGlmIChyZWNvbm5lY3RUaW1lb3V0UmVmLmN1cnJlbnQpIHtcbiAgICAgIGNsZWFyVGltZW91dChyZWNvbm5lY3RUaW1lb3V0UmVmLmN1cnJlbnQpO1xuICAgICAgcmVjb25uZWN0VGltZW91dFJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgY29ubmVjdCgpO1xuICB9LCBbdXNlcklkLCBjb25uZWN0XSk7XG5cbiAgLy8gSW5pdGlhbGl6ZSBjb25uZWN0aW9uIHdoZW4gdXNlcklkIGNoYW5nZXNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBjb25uZWN0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVwZGF0ZUNvbm5lY3Rpb25TdGF0ZShcImRpc2Nvbm5lY3RlZFwiKTtcbiAgICB9XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKHJlY29ubmVjdFRpbWVvdXRSZWYuY3VycmVudCkge1xuICAgICAgICBjbGVhclRpbWVvdXQocmVjb25uZWN0VGltZW91dFJlZi5jdXJyZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbdXNlcklkLCBjb25uZWN0LCB1cGRhdGVDb25uZWN0aW9uU3RhdGVdKTtcblxuICBjb25zdCBpc0Nvbm5lY3RlZCA9IGNvbm5lY3Rpb25TdGF0ZSA9PT0gXCJjb25uZWN0ZWRcIjtcbiAgY29uc3QgaXNDb25uZWN0aW5nID0gY29ubmVjdGlvblN0YXRlID09PSBcImNvbm5lY3RpbmdcIjtcbiAgY29uc3QgaGFzRXJyb3IgPSBjb25uZWN0aW9uU3RhdGUgPT09IFwiZXJyb3JcIjtcblxuICBjb25zdCBjb250ZXh0VmFsdWU6IENoYXRDb250ZXh0VHlwZSA9IHtcbiAgICBtZXNzYWdlcyxcbiAgICBzZW5kTWVzc2FnZSxcbiAgICBpc0Nvbm5lY3RlZCxcbiAgICBpc0Nvbm5lY3RpbmcsXG4gICAgaGFzRXJyb3IsXG4gICAgY29ubmVjdGlvblN0YXR1czogY29ubmVjdGlvblN0YXRlLFxuICAgIHJlY29ubmVjdCxcbiAgICBhZGRNZXNzYWdlTGlzdGVuZXIsXG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8Q2hhdENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHRWYWx1ZX0+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9DaGF0Q29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUNoYXQoKSB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KENoYXRDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwidXNlQ2hhdCBtdXN0IGJlIHVzZWQgd2l0aGluIGEgQ2hhdFByb3ZpZGVyXCIpO1xuICB9XG4gIHJldHVybiBjb250ZXh0O1xufSAiXSwibmFtZXMiOlsiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwidXNlQ29udGV4dCIsInVzZUVmZmVjdCIsInVzZVN0YXRlIiwidXNlUmVmIiwidXNlQ2FsbGJhY2siLCJTb2NrSlMiLCJDbGllbnQiLCJDaGF0Q29udGV4dCIsImdsb2JhbENsaWVudCIsImdsb2JhbENvbm5lY3Rpb25TdGF0ZSIsIm1lc3NhZ2VMaXN0ZW5lcnMiLCJTZXQiLCJwcm9jZXNzZWRNZXNzYWdlcyIsIkNoYXRQcm92aWRlciIsImNoaWxkcmVuIiwidXNlcklkIiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImNvbm5lY3Rpb25TdGF0ZSIsInNldENvbm5lY3Rpb25TdGF0ZSIsInJlY29ubmVjdFRpbWVvdXRSZWYiLCJjb25uZWN0aW9uQXR0ZW1wdHNSZWYiLCJtYXhSZWNvbm5lY3RBdHRlbXB0cyIsInJlY29ubmVjdERlbGF5IiwiaXNDb25uZWN0aW5nUmVmIiwidXBkYXRlQ29ubmVjdGlvblN0YXRlIiwibmV3U3RhdGUiLCJhZGRNZXNzYWdlTGlzdGVuZXIiLCJsaXN0ZW5lciIsImFkZCIsImRlbGV0ZSIsIm5vdGlmeU1lc3NhZ2VMaXN0ZW5lcnMiLCJtc2ciLCJmb3JFYWNoIiwiZXJyb3IiLCJjb25zb2xlIiwiY29ubmVjdCIsImN1cnJlbnQiLCJjb25uZWN0ZWQiLCJsb2ciLCJkZWFjdGl2YXRlIiwid2FybiIsImNsZWFyVGltZW91dCIsInNvY2tldCIsImNsaWVudCIsIndlYlNvY2tldEZhY3RvcnkiLCJoZWFydGJlYXRJbmNvbWluZyIsImhlYXJ0YmVhdE91dGdvaW5nIiwib25Db25uZWN0Iiwic3Vic2NyaWJlIiwibWVzc2FnZSIsImJvZHkiLCJKU09OIiwicGFyc2UiLCJjb250ZW50IiwibWVzc2FnZUtleSIsImlkIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInNlbmRlcklkIiwiaGFzIiwic2l6ZSIsIm1lc3NhZ2VzQXJyYXkiLCJBcnJheSIsImZyb20iLCJjbGVhciIsInNsaWNlIiwicHJldiIsImpvaW5NZXNzYWdlIiwic2VuZGVyTmFtZSIsInJlY2VpdmVySWQiLCJsaXN0aW5nSWQiLCJwdWJsaXNoIiwiZGVzdGluYXRpb24iLCJzdHJpbmdpZnkiLCJvbkRpc2Nvbm5lY3QiLCJzZXRUaW1lb3V0Iiwib25TdG9tcEVycm9yIiwib25XZWJTb2NrZXRFcnJvciIsIm9uV2ViU29ja2V0Q2xvc2UiLCJhY3RpdmF0ZSIsInNlbmRNZXNzYWdlIiwicmVjb25uZWN0IiwiaXNDb25uZWN0ZWQiLCJpc0Nvbm5lY3RpbmciLCJoYXNFcnJvciIsImNvbnRleHRWYWx1ZSIsImNvbm5lY3Rpb25TdGF0dXMiLCJQcm92aWRlciIsInZhbHVlIiwidXNlQ2hhdCIsImNvbnRleHQiLCJFcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/contexts/ChatContext.tsx\n"));

/***/ })

});